<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Arial; color: #000000; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Arial; color: #000000; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="it"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;Gestione Clienti - Moderna&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* Stili CSS */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>:root {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--primary-color: #4a90e2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--secondary-color: #f5a623;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--background-color: #f0f4f8;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--text-color: #333;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--border-radius: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--background-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--text-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 800px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 2rem auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>h1 {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: var(--primary-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.input-group {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gap: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>input {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex: 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 0.75rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 1px solid #ddd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 0.75rem 1.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: background-color 0.3s, transform 0.1s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button:active {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: translateY(1px);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#aggiungiButton {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--primary-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#micButton {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--secondary-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#micButton.listening {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #e74c3c;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#statusMessage {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 0.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #e8f5e9;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>table {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-collapse: separate;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-spacing: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th, td {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-bottom: 1px solid #ddd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--primary-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th:first-child {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-top-left-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th:last-child {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-top-right-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tr:last-child td:first-child {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-bottom-left-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tr:last-child td:last-child {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-bottom-right-radius: var(--border-radius);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-btn, .save-btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: var(--primary-color);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.cancel-btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #e74c3c;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h1&gt;Gestione Clienti&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="nome" placeholder="Nome"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="prodotto" placeholder="Prodotto"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="citta" placeholder="Città"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button id="aggiungiButton"&gt;Aggiungi Cliente&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button id="micButton"&gt;🎤 Attiva/Disattiva Vocale&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button id="copiaButton"&gt;Copia negli appunti&lt;/button&gt; &lt;!-- Aggiungi il pulsante "Copia negli appunti" --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="statusMessage"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;th&gt;Nome&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;th&gt;Prodotto&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;th&gt;Città&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;th&gt;Azioni&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tbody id="clientiBody"&gt;&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let clienti = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let recognition;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let isListening = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function initSpeechRecognition() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if ('webkitSpeechRecognition' in window) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition = new webkitSpeechRecognition();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.continuous = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.interimResults = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.lang = 'it-IT';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.onresult = function(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const transcript = event.results[0][0].transcript.toLowerCase().trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>processVoiceInput(transcript);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.onerror = function(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Errore nel riconoscimento vocale: ", event.error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>updateStatus("Errore nel riconoscimento vocale. Riprova.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>stopListening();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.onend = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (isListening) startListening();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Il riconoscimento vocale non è supportato in questo browser.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Il riconoscimento vocale non è supportato in questo browser.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function processVoiceInput(transcript) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>updateStatus("Analisi del messaggio vocale...");</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const paroleChiave = ['nome', 'prodotto', 'città'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let dati = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let campoCorrente = null;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const parole = transcript.split(' ');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 0; i &lt; parole.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const parola = parole[i].toLowerCase();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (paroleChiave.includes(parola)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>campoCorrente = parola === 'città' ? 'citta' : parola;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>dati[campoCorrente] = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else if (campoCorrente) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>dati[campoCorrente] += (dati[campoCorrente] ? ' ' : '') + parole[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let campo in dati) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>dati[campo] = dati[campo].trim().replace(/,$/, '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (Object.keys(dati).length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (let [campo, valore] of Object.entries(dati)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (valore) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>document.getElementById(campo).value = valore;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Campi compilati automaticamente.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Non ho potuto estrarre informazioni dal messaggio vocale.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function toggleListening() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (isListening) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stopListening();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>startListening();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function startListening() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (recognition) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.start();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>isListening = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('micButton').classList.add('listening');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Ascolto attivo. Pronuncia le informazioni del cliente.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function stopListening() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (recognition) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recognition.stop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>isListening = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('micButton').classList.remove('listening');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Ascolto terminato");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function aggiungiCliente() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const nome = document.getElementById('nome').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const prodotto = document.getElementById('prodotto').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const citta = document.getElementById('citta').value;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (nome &amp;&amp; prodotto &amp;&amp; citta) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>clienti.push({nome, prodotto, citta});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>aggiornaTabella();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>pulisciCampi();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Cliente aggiunto con successo!");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Per favore, compila tutti i campi.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function aggiornaTabella() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const tbody = document.getElementById('clientiBody');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>tbody.innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>clienti.forEach((cliente, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const row = tbody.insertRow();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;${cliente.nome}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;${cliente.prodotto}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;${cliente.citta}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button class="edit-btn" onclick="modificaCliente(${index})"&gt;Modifica&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button class="cancel-btn" onclick="rimuoviCliente(${index})"&gt;Elimina&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function rimuoviCliente(index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>clienti.splice(index, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aggiornaTabella();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>updateStatus("Cliente rimosso con successo!");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function modificaCliente(index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const row = document.getElementById('clientiBody').rows[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const cliente = clienti[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;&lt;input type="text" id="edit-nome-${index}" value="${cliente.nome}"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;&lt;input type="text" id="edit-prodotto-${index}" value="${cliente.prodotto}"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;&lt;input type="text" id="edit-citta-${index}" value="${cliente.citta}"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button class="save-btn" onclick="salvaModifiche(${index})"&gt;Salva&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button class="cancel-btn" onclick="annullaModifiche()"&gt;Annulla&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function salvaModifiche(index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const nome = document.getElementById(`edit-nome-${index}`).value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const prodotto = document.getElementById(`edit-prodotto-${index}`).value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const citta = document.getElementById(`edit-citta-${index}`).value;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (nome &amp;&amp; prodotto &amp;&amp; citta) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>clienti[index] = {nome, prodotto, citta};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>aggiornaTabella();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Cliente modificato con successo!");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Per favore, compila tutti i campi.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function annullaModifiche() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aggiornaTabella();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>updateStatus("Modifiche annullate.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function pulisciCampi() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('nome').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('prodotto').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('citta').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function updateStatus(message) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('statusMessage').textContent = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function copiaNegliAppunti() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let tabella = document.querySelector('table');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let righe = Array.from(tabella.rows);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Salta la prima riga (i titoli delle colonne)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let testoDaCopiare = righe.slice(1).map(riga =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let celle = Array.from(riga.cells);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Escludi l'ultima cella (i pulsanti di azione)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return celle.slice(0, -1).map(cell =&gt; cell.innerText).join('\t');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}).join('\n');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>navigator.clipboard.writeText(testoDaCopiare).then(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Dati copiati negli appunti!");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}).catch(err =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Errore durante la copia negli appunti: ", err);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateStatus("Errore durante la copia negli appunti.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>initSpeechRecognition();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('aggiungiButton').addEventListener('click', aggiungiCliente);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('micButton').addEventListener('click', toggleListening);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('copiaButton').addEventListener('click', copiaNegliAppunti); // Aggiungi l'evento click per il pulsante "Copia negli appunti"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aggiornaTabella();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
